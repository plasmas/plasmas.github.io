<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Mini-Minecraft | Yuanqi Wang </title> <meta name="author" content="Yuanqi Wang"> <meta name="description" content="A simple Minecraft clone written in C++ and OpenGL."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%A8%F0%9F%8F%BB%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://www.yqwong.com/projects/mini-minecraft/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Yuanqi</span> Wang </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Mini-Minecraft</h1> <p class="post-description">A simple Minecraft clone written in C++ and OpenGL.</p> </header> <article> <p><a href="https://github.com/plasmas/Mini-Minecraft" rel="external nofollow noopener" target="_blank">Source</a></p> <p><em>Per course policy, access to code is only granted upon request.</em></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <iframe src="https://www.youtube-nocookie.com/embed/khf67kJt4hQ" class="img-fluid rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"></iframe> </figure> </div> </div> <h2 id="highlights">Highlights</h2> <ul> <li>Implemented a procedural terrain generation system using Perlin noise, featuring multiple biomes and a complex cave system.</li> <li>Developed a multithreaded chunk generation and loading system using Qt, ensuring smooth gameplay and efficient resource management.</li> <li>Created visually appealing effects, including animated textures, a realistic day-night cycle, water waves, distance fog, and dynamic grass coloring.</li> <li>Engineered robust player movement and interaction mechanics, including precise collision detection, block breaking, and placing functionality.</li> </ul> <hr> <h2 id="procedural-terrain-generation">Procedural Terrain Generation</h2> <h3 id="biome-system">Biome System</h3> <p>The terrain is procedurally generated using a simple Perlin noise algorithm. The terrain is generated in chunks, and the chunks are loaded and unloaded as the player moves around the world. There are 4 types of biomes in the world:</p> <ul> <li>mountain (stone blocks with snow on top if the height is over 190, using 2d fbm noise function)</li> <li>snow land (dirt blocks with snow on top using 2d Perlin noise)</li> <li>grassland (dirt blocks with grass on top using smooth 2d Perlin noise, when the temperature is low, the grass is yellow)</li> <li>desert (sand blocks using 2d Perlin noise with small amplitude).</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Mountain &amp; Snow land biome" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Grassland biome" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Dessert biome" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Mountain &amp; Snow land biome; Middle: Grassland biome; Right: Dessert biome. </div> <p>Also, there is a cave system in this world, 3D perlin noise functions are used with large grid size to generate caves beneath the terrain’s surface, and if the height is lower enough, the cave will be filled with lava.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Lava Cave System" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Lava Cave system </div> <h3 id="multithreaded-generation-and-chunk-loading">Multithreaded Generation and Chunk Loading</h3> <p>We used multithreading primitives in <code class="language-plaintext highlighter-rouge">Qt</code> to load and generate chunks in parallel. This allows for a smooth experience when moving around the world. <code class="language-plaintext highlighter-rouge">QRunnable</code>, <code class="language-plaintext highlighter-rouge">QThreadPool</code> and <code class="language-plaintext highlighter-rouge">QMutex</code> are used for this purpose. The following classes are implemented:</p> <ul> <li> <p>BlockTypeWorker: Extends QRunnable, which is responsible for creating chunks of a terrain zone, and will be used in initializing terrain and expand terrain. The generated chunks will be added to a vector and will be used in creating VBO data later at each tick.</p> </li> <li> <p>VBOWorker: Responsible for creates the VBO data for a given chunk and pushed to a vector which will be passed to GPU in main thread.</p> </li> </ul> <p>In general, each chunk’s type is computed once in a worker thread, and persists for the lifecycle of the program. The VBO data, however, is generated based on the player’s position and is updated every frame. Chunks which are not visible to the player are offloaded from the GPU, and chunks which are visible are generated in worker threads and loaded into the GPU by the main thread.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Fast Terrain Generation &amp; Loading" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Terrain Offloading" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Fast Terrain Generation &amp; Loading; Right: Terrain Offloading. </div> <hr> <h2 id="visual-effects">Visual Effects</h2> <h3 id="animated-textures">Animated Textures</h3> <p>Animated textures were developed to enhance the visual appeal of the game environment. UV offsets were coded into the static face array, allowing for precise texture mapping on block faces. A unique approach was taken to animate textures, where a flag in the VBO data indicates the need for animation, and a time variable in the shader controls the animation pace. This resulted in a distinctive, stepwise movement of water and other textures, adding a dynamic element to the game world.</p> <h3 id="day-night-cycle">Day-Night Cycle</h3> <p>The day-night cycle was implemented to add realism and depth to the game’s atmosphere. An increment timer calculates the sun’s direction, and the color of the sky is interpolated based on the angle between a ray cast and the sun’s direction. This creates a smooth transition between day and night, dynamically changing the sky’s color and enhancing the immersive experience of the game.</p> <h3 id="water-waves">Water Waves</h3> <p>To simulate the natural movement of water, a <strong>sine function</strong> was used to distort the water surface, creating realistic water waves. Height field sampling was employed to accurately determine the normals for the distorted surface, allowing for effective application of <strong>Blinn-Phong shading</strong>. This technique made the changes in the water’s surface more visible, significantly improving the game’s visual quality.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Animated Texture of Lava" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Day-Night Cycle" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Water Waves" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Animated Texture of Lava; Middle: Day-Night Cycle; Right: Water Waves. </div> <h3 id="distance-fog">Distance Fog</h3> <p>Distance fog was introduced to add depth to the game world and improve rendering performance by obscuring distant objects. The distance between each block and the player’s camera is calculated, and the block’s color is interpolated with a foggy white based on that distance using the smoothstep function. This effect not only enhances the visual appeal of the game but also contributes to a more efficient rendering of the game environment.</p> <h3 id="procedural-grass-coloring">Procedural Grass Coloring</h3> <p>Procedural grass coloring was added to diversify the environment, making it more vibrant and realistic. A new block type for grey grass was introduced, and the color of the grass was adjusted in the fragment shader to appear darker and yellowish in colder areas. This dynamic color variation responds to the simulated temperature conditions in the game world, adding depth and realism to the grassland biome and enhancing the overall immersive experience.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Distance Fog" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Procedural Grass Coloring" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Distance Fog; Right: Procedural Grass Coloring. </div> <hr> <h2 id="player-movement-and-interaction">Player Movement and Interaction</h2> <h3 id="controls">Controls</h3> <p>In the <code class="language-plaintext highlighter-rouge">tick</code> function, the <code class="language-plaintext highlighter-rouge">InputBundle</code> is processed to update the player’s acceleration and velocity. A drag force is applied to the player to simulate air resistance.</p> <h3 id="collision-detection">Collision Detection</h3> <p>In each tick, compute the displacement of the player and <strong>grid march</strong> from all 12 vertices of the player hit box. Compute the minimum distance the player can move in all 3 directions. Then move the player with the minimum distance (minus a very small offset).</p> <h3 id="block-breaking-and-placing">Block Breaking and Placing</h3> <p>On mouse button click, cast a ray of length 3 from camera position. To delete a block, if the ray hits a block, set the block type to <code class="language-plaintext highlighter-rouge">EMPTY</code>. To add a block, check the ray hit point on the block to determine the position to add the new block. Then set the new block type to <code class="language-plaintext highlighter-rouge">STONE</code>.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Collision Detection" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/placeholder-480.webp 480w,/assets/img/placeholder-800.webp 800w,/assets/img/placeholder-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/placeholder.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Block Breaking &amp; Placing" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Collision Detection; Right: Block Breaking &amp; Placing. </div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Yuanqi Wang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: June 29, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>