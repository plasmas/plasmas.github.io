<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Vulkan Grass Rendering | Yuanqi Wang </title> <meta name="author" content="Yuanqi Wang"> <meta name="description" content="Efficient grass rendering using Vulkan and C++, using quadratic Bézier curves to model grass blades."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%A8%F0%9F%8F%BB%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://www.yqwong.com/projects/vulkan-grass/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Yuanqi</span> Wang </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Vulkan Grass Rendering</h1> <p class="post-description">Efficient grass rendering using Vulkan and C++, using quadratic Bézier curves to model grass blades.</p> </header> <article> <p><a href="https://github.com/plasmas/Project5-Vulkan-Grass-Rendering-2023" rel="external nofollow noopener" target="_blank">Source</a></p> <p><em>Tested on: Windows 11, i5-11600K @ 3.91GHz 32GB, RTX 4090 24GB (Personal Desktop)</em></p> <h2 id="overview">Overview</h2> <p>A quadratic Bézier curve is a parametric curve used in computer graphics and related fields to model smooth curves. Using quadratic Bézier curves to model grass allows for both aesthetic realism and computational efficiency. This method can create a wide variety of grass shapes and appearances by simply adjusting the positions of the control points. It’s particularly effective in real-time rendering applications, like video games or simulations, where performance is critical, but a reasonable level of realism is also required.</p> <p>In this project, I simulate the grass using quadratic Bézier curves based on the method introduced in this paper: <a href="https://www.cg.tuwien.ac.at/research/publications/2017/JAHRMANN-2017-RRTG/JAHRMANN-2017-RRTG-draft.pdf" rel="external nofollow noopener" target="_blank">Responsive Real-Time Grass Rendering for General 3D Scenes</a>.</p> <div align="center"> <img src="/assets/img/projects/vulkan-grass/blade_model.jpg" style="width: 60%; height: auto;"> </div> <p>The blade of grass is represented using a quadratic Bézier curve defined by three control points and some essential attributes:</p> <p>\(v_0\): This is the base point, anchored at the ground level. It acts as the starting point of the grass blade.</p> <p>\(v_1\): This is the control point that doesn’t lie on the curve itself but influences its shape. It essentially dictates the bend or curvature of the grass blade.</p> <p>\(v_2\): This is the endpoint of the curve and represents the tip of the grass blade.</p> <p><em>direction:</em> The general leaning or orientation of the grass blade.</p> <p><em>height:</em> The height of grass blade from base to tip (from \(v_0\) to \(v_2\)).</p> <p><em>width:</em> The thickness of the grass blade base.</p> <p><em>up-vector:</em> a directional vector indicating the vertical orientation in 3D space. This usually aligned with the normal of the plane.</p> <hr> <h2 id="features">Features</h2> <h3 id="physics-simulation">Physics Simulation</h3> <p>To properly simulate grass movement, a combination of recovery, gravity, and wind is used. These animations show grass movement when different forces are considered:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/no_force-480.webp 480w,/assets/img/projects/vulkan-grass/no_force-800.webp 800w,/assets/img/projects/vulkan-grass/no_force-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/no_force.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="No Force" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/gravity-480.webp 480w,/assets/img/projects/vulkan-grass/gravity-800.webp 800w,/assets/img/projects/vulkan-grass/gravity-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/gravity.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Gravity Only" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: No Force; Right: Gravity Only. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/recovery-480.webp 480w,/assets/img/projects/vulkan-grass/recovery-800.webp 800w,/assets/img/projects/vulkan-grass/recovery-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/recovery.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Gravity + Recovery" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/wind-480.webp 480w,/assets/img/projects/vulkan-grass/wind-800.webp 800w,/assets/img/projects/vulkan-grass/wind-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/wind.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Gravity + Recovery + Wind" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Gravity + Recovery; Right: Gravity + Recovery + Wind. </div> <p>It is clear that when no force is applied, all blades of grass sts the same. When gravity is the only force, all grass fell to the ground since there is no stiffness or recovery force. When Recovery force is added, blades now have a natural curve. And finally when wind force is applied, the grass will move as wind direction and strength are different at varying locations and times.</p> <hr> <h3 id="culling">Culling</h3> <p>To improve performance, different culling methods are used to discard blades that are not or less visible.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/no_culling-480.webp 480w,/assets/img/projects/vulkan-grass/no_culling-800.webp 800w,/assets/img/projects/vulkan-grass/no_culling-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/no_culling.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="No Culling" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/orient_culling-480.webp 480w,/assets/img/projects/vulkan-grass/orient_culling-800.webp 800w,/assets/img/projects/vulkan-grass/orient_culling-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/orient_culling.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Orientation Culling" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: No Culling; Right: Orientation Culling. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/frustrum_culling-480.webp 480w,/assets/img/projects/vulkan-grass/frustrum_culling-800.webp 800w,/assets/img/projects/vulkan-grass/frustrum_culling-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/frustrum_culling.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Frustrum Culling" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/vulkan-grass/dist_culling-480.webp 480w,/assets/img/projects/vulkan-grass/dist_culling-800.webp 800w,/assets/img/projects/vulkan-grass/dist_culling-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/vulkan-grass/dist_culling.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Distance Culling" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: Frustrum Culling; Right: Distance Culling. </div> <p>With orientation culling we can see that some blades which are alighed with the viewing direction is omitted. With frustrum culling, If all \(v_0\), \(v_2\), and \(m\) are not in the frustrum, the blade will be omitted. With distance culling, blades that are too far away will be omitted.</p> <hr> <h3 id="performance-analysis">Performance Analysis</h3> <h4 id="number-of-blades">Number of Blades</h4> <p>To analyse performance, we tested FPS under different number of blades. No culling is used in this testing.</p> <div align="center"> <img src="/assets/img/projects/vulkan-grass/fps_vs_blades.svg" style="width: 60%; height: auto;"> </div> <p>Since both axis are log-based. We can see that the FPS decreases linearly with the number of blades. This is expected as the render cost increases linearly with the number of blades.</p> <h4 id="culling-1">Culling</h4> <p>The actual performance benefit we can get from culling is highly dependent on the camera’s position and viewing direction, as well as culling parameters. As a rule of thumb, the more blades culled by some culling rule, the more benefits we will gain from that rule. However, it does not mean that culling rules that yield less performance boost is less important, as it will vary a lot based in different scene and viewing situations.</p> <p>For this part, I solely examine the FPS boost I get when not moving the position and viewing angle of the camera. The number of blades is set to \(10^{15}\).</p> <div align="center"> <img src="/assets/img/projects/vulkan-grass/culling.svg" style="width: 60%; height: auto;"> </div> <p>We can see that this is camera setup, performance benefits greatly from orientation culling. This is expected as a lot of the blades will be discarded based on their orientation against the camera. Frustrum culling introduces a small performance gain because in this camera setup, most of the blades are still within the frustrum. With all three culling enabled, a huge performance boost is obtained, as a massive portion of blades that are not visible is reduced from the rendering.</p> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Yuanqi Wang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: June 29, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>